function init(){ajax("offer.json",function(t){var t=JSON.parse(t.responseText),e=t.products;populate(e)})}function populate(t){t.map(function(t){var e=toClassName(t.tag),n=document.getElementById("offer_wraper"),a=document.createElement("div");a.classList.add("offer"),a.classList.add("offer"+t.id),a.setAttribute("data-id",t.id),a.setAttribute("data-des",t.description),a.setAttribute("data-logo",t.logo),a.setAttribute("data-brand",t.brand),a.setAttribute("data-img",t.image),a.setAttribute("data-tag",t.tag),a.setAttribute("data-name",t.name),a.innerHTML+='<img class = "offer_img" src = "'+t.image+'">\t\t\t<div class = "tag '+e+'" >\t\t\t\t<h6>'+t.tag+"</h6>\t\t\t</div>\t\t\t<h5>"+t.name+'</h5>\t\t\t<div class = "info" >\t\t\t\t<img src="/path/to/img_info.png" />\t\t\t</div>',n.appendChild(a)}),openInfo(),select(toggle)}function select(t){for(var e=document.querySelectorAll(".offer"),n=0;n<e.length;n++)e[n].onclick=t}function toggle(t){t.stopPropagation();var e=this;toggleOrNot(e)}function toggleOrNot(t,e){var n=e||!1,a=new RegExp("selected").test(t.getAttribute("class"));if(n)a?(t.classList.add("shake"),animated(t,function(){t.classList.remove("shake")})):document.querySelectorAll(".selected").length<5&&(t.classList.toggle("selected"),activeBtn());else if(document.querySelectorAll(".selected").length>=5){if(a!==!0){var o=document.getElementById("select-btn");return o.classList.add("flash"),console.log("+btn!!!!!"),void animated(o,function(){o.classList.remove("flash")})}t.classList.toggle("selected"),activeBtn(),console.log("from here!!!!!")}else t.classList.toggle("selected"),activeBtn()}function doubleChosenOrNot(){}function countNum(){var t=document.getElementById("num"),e=document.querySelectorAll(".selected").length;return t.textContent=e,e}function activeBtn(){var t=document.getElementById("select-btn");5==countNum()?(t.classList.add("actived"),t.setAttribute("href","http://www.sampler.io"),t.addEventListener("click",function(){console.log(location),location.href="http://www.sampler.io"})):(t.setAttribute("class","btn"),t.setAttribute("href",""),t.addEventListener("click",function(t){t.preventDefault()}))}function openInfo(){for(var t=document.querySelectorAll(".info"),e=document.getElementById("modal"),n=0;n<t.length;n++)t[n].addEventListener("click",function(t){t.stopPropagation();var n=this.parentElement,a=n.dataset.des,o=n.dataset.id,s=n.dataset.logo,l=n.dataset.brand,i=n.dataset.img,d=n.dataset.tag,c=n.dataset.name,r=document.querySelector(".overlay");e.setAttribute("data-iid",o),e.innerHTML='<header>\t\t\t\t\t\t\t\t<h5>Offer Details</h5><div class = "close">x</div>\t\t\t\t\t\t\t</header>\t\t\t\t\t\t\t<main>\t\t\t\t\t\t\t\t<div class="banner">\t\t\t\t\t\t\t\t\t<img src="'+i+'">\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class = "content">\t\t\t\t\t\t\t\t\t<div class = "tag '+toClassName(d)+'">\t\t\t\t\t\t\t\t\t\t<h6>'+d+"</h6>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<h3>"+c+'</h3>\t\t\t\t\t\t\t\t\t<div class="logo">\t\t\t\t\t\t\t\t\t\t<img src="'+s+'">\t\t\t\t\t\t\t\t\t\t<p>'+l+'</p>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<p class="des">'+a+'</p>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</main>\t\t\t\t\t\t\t<footer>\t\t\t\t\t\t\t\t<div class = "btn" id = "select-btn-modal">\t\t\t\t\t\t\t\t\tSelect Offer\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</footer>',e.classList.add("block"),r.classList.add("block"),document.body.style.overflow="hidden",close(),selectFromModal()},!1)}function selectFromModal(){var t=document.getElementById("select-btn-modal");t.addEventListener("click",function(){var t=this.parentElement.parentElement,e=t.dataset.iid,n=document.querySelector(".offer"+e),a=document.querySelector(".overlay");a.classList.remove("block"),toggleOrNot(n,!0),killModel(t)})}function close(){for(var t=document.querySelectorAll(".close"),e=0;e<t.length;e++)t[e].addEventListener("click",function(){var t=this.parentElement.parentElement;killModel(t);var e=document.querySelector(".overlay");e.classList.remove("block")});var n=document.querySelector(".overlay");n.addEventListener("click",function(){var t=document.getElementById("modal"),e=document.querySelector(".overlay");e.classList.remove("block"),killModel(t)})}function killModel(t){t.classList.add("fadeOut"),setTimeout(function(){t.setAttribute("class","modal")},1e3),document.body.style.overflow="auto"}function ajax(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&e(n)},n.open("GET",t,!0),n.send()}function animated(t,e){t.addEventListener("webkitAnimationEnd",e,!1),t.addEventListener("animationend",e,!1),t.addEventListener("oanimationend",e,!1)}function toClassName(t){return t.replace(" ","-").replace("+","").toLowerCase()}window.addEventListener("load",function(){init()});